<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{base::layout(~{::section})}">
<head>
    <meta charset="ISO-8859-1">
    <title>Your Profile</title>
</head>
<body>
<section>
    <div class="profile_page_v2">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="profile_card_v2">
                        <!-- Header Section -->
                        <div class="profile_header_v2">
                            <h1 class="profile_title_v2">My Profile</h1>
                        </div>

                        <!-- Alert Messages -->
                        <div class="profile_form_v2">
                            <th:block th:if="${session.successMsg}">
                                <div class="alert_message_v2 success_message_v2">
                                    <i class="fas fa-check-circle me-2"></i>
                                    <span class="fw-bold">[[${session.successMsg}]]</span>
                                </div>
                                <th:block th:text="${@commonServiceImpl.removeSessionMsg()}"></th:block>
                            </th:block>

                            <th:block th:if="${session.errorMsg}">
                                <div class="alert_message_v2 error_message_v2">
                                    <i class="fas fa-exclamation-circle me-2"></i>
                                    <span class="fw-bold">[[${session.errorMsg}]]</span>
                                </div>
                                <th:block th:text="${@commonServiceImpl.removeSessionMsg()}"></th:block>
                            </th:block>

                            <!-- Profile Image -->
                            <div class="profile_image_section_v2">
                                <div class="profile_image_container_v2">
                                    <img th:src="@{'../img/profile_img/'+${user.profileImage}}"
                                         alt="Profile" class="profile_image_v2">
                                    <label for="profile_upload" class="profile_image_upload_v2">
                                        <i class="fas fa-camera"><input type="file" name="img" class="form-control" value="" style="opacity: 0; position: absolute; left: 0; width: 100%; height: 100%; cursor: pointer;">
                                        </i>
                                    </label>
                                </div>
                            </div>

                            <!-- Profile Form -->
                            <form action="/user/update-profile" method="post" enctype="multipart/form-data">
                                <input type="file" id="profile_upload" name="img" style="display: none"
                                       onchange="document.querySelector('form').submit()">

                                <div class="form_grid_v2">
                                    <div class="input_group_v2">
                                        <label class="input_label_v2">Full Name</label>
                                        <input type="text" name="name" class="input_field_v2"
                                               th:value="${user.name}">
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">Mobile Number</label>
                                        <input type="number" name="mobileNumber" class="input_field_v2"
                                               th:value="${user.mobileNumber}">
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">Email Address</label>
                                        <input type="email" name="email" class="input_field_v2 readonly_field_v2"
                                               th:value="${user.email}" readonly>
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">Address</label>
                                        <input type="text" name="address" class="input_field_v2"
                                               th:value="${user.address}">
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">City</label>
                                        <input type="text" name="city" class="input_field_v2"
                                               th:value="${user.city}">
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">State</label>
                                        <input type="text" name="state" class="input_field_v2"
                                               th:value="${user.state}">
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">Pincode</label>
                                        <input type="number" name="pincode" class="input_field_v2"
                                               th:value="${user.pincode}">
                                    </div>

                                    <div class="input_group_v2">
                                        <label class="input_label_v2">Role</label>
                                        <input type="text" name="role" class="input_field_v2 readonly_field_v2"
                                               th:value="${user.role}" readonly>
                                    </div>
                                </div>

                                <input type="hidden" th:value="${user.id}" name="id">
                                <div class="mt-4">
                                    <button class="profile_submit_btn_v2">
                                        <i class="fas fa-save me-2"></i>Update Profile
                                    </button>
                                </div>
                            </form>

                            <!-- Password Change Section -->
                            <div class="password_section_v2">
                                <h2 class="section_title_v2">Change Password</h2>
                                <form action="/user/change-password" method="post">
                                    <div class="row justify-content-center">
                                        <div class="col-md-8">
                                            <div class="input_group_v2">
                                                <label class="input_label_v2">Current Password</label>
                                                <input type="password" name="currentPassword"
                                                       class="input_field_v2"
                                                       th:value="${user.password}">
                                            </div>

                                            <div class="input_group_v2">
                                                <label class="input_label_v2">New Password</label>
                                                <input type="password" name="newPassword"
                                                       class="input_field_v2">
                                            </div>

                                            <div class="input_group_v2">
                                                <label class="input_label_v2">Confirm Password</label>
                                                <input type="password" name="confirmPassword"
                                                       class="input_field_v2">
                                            </div>

                                            <div class="mt-4">
                                                <button class="profile_submit_btn_v2">
                                                    <i class="fas fa-key me-2"></i>Update Password
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
</html>